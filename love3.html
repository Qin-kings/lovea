<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>æƒ…ä¾£å°ç«™ â¤ï¸</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-pink-200 via-pink-300 to-pink-400 min-h-screen flex flex-col items-center p-6">
  <h1 class="text-4xl font-bold text-white mb-6">æˆ‘ä»¬çš„æƒ…ä¾£å°ç«™ ğŸ’•</h1>

  <!-- å¤´åƒä¸Šä¼ ï¼ˆä¿ç•™é€‰æ‹©æ–‡ä»¶ï¼Œä¸æ˜¾ç¤ºä¿å­˜è·¯å¾„ï¼‰ -->
  <div class="bg-white rounded-2xl shadow-lg p-6 w-full max-w-3xl mb-6">
    <h2 class="text-xl font-semibold mb-4">æˆ‘ä»¬çš„å¤´åƒ</h2>
    <div class="flex gap-6">
      <div class="flex flex-col items-center">
        <img id="avatar1" class="w-24 h-24 rounded-full object-cover border-2 mb-2" src="love/images/qinbaotai.png" alt="å¤´åƒ1">
        <!-- ä»…ä¿ç•™é€‰æ‹©æ–‡ä»¶æŒ‰é’® -->
        <input type="file" accept="image/*" onchange="uploadAvatar(event, 'avatar1')">
        <!-- å¯é€‰ï¼šæ¢å¤ä»“åº“å›¾ç‰‡ï¼ˆé»˜è®¤ï¼‰ -->
        <button onclick="restoreDefault('avatar1')" class="mt-2 px-2 py-1 bg-gray-200 text-sm rounded">æ¢å¤é»˜è®¤</button>
        <p class="text-sm text-gray-500 mt-1">Ta ğŸ’–</p>
      </div>

      <div class="flex flex-col items-center">
        <img id="avatar2" class="w-24 h-24 rounded-full object-cover border-2 mb-2" src="" alt="å¤´åƒ2">
        <input type="file" accept="image/*" onchange="uploadAvatar(event, 'avatar2')">
        <button onclick="restoreDefault('avatar2')" class="mt-2 px-2 py-1 bg-gray-200 text-sm rounded">æ¢å¤é»˜è®¤</button>
        <p class="text-sm text-gray-500 mt-1">æˆ‘ ğŸ’™</p>
      </div>
    </div>
  </div>

  <!-- ä¸ªäººä¿¡æ¯ -->
  <div class="bg-white rounded-2xl shadow-lg p-6 w-full max-w-3xl mb-6">
    <h2 class="text-xl font-semibold mb-4">ä¸ªäººä¿¡æ¯</h2>
    <div class="grid grid-cols-2 gap-6">
      <div>
        <h3 class="font-bold mb-2">Ta ğŸ’–</h3>
        <input id="info1" class="w-full p-2 border rounded" placeholder="å§“å, å¹´é¾„, èº«é«˜, å…´è¶£çˆ±å¥½...">
      </div>
      <div>
        <h3 class="font-bold mb-2">æˆ‘ ğŸ’™</h3>
        <input id="info2" class="w-full p-2 border rounded" placeholder="å§“å, å¹´é¾„, èº«é«˜, å…´è¶£çˆ±å¥½...">
      </div>
    </div>
    <button onclick="saveInfo()" class="mt-4 px-4 py-2 bg-pink-400 text-white rounded-xl shadow">ä¿å­˜</button>
  </div>

  <!-- ç›¸çˆ±æ—¶é•¿ -->
  <div class="bg-white rounded-2xl shadow-lg p-6 w-full max-w-3xl mb-6">
    <h2 class="text-xl font-semibold mb-4">æˆ‘ä»¬çš„ç›¸çˆ±æ—¶é•¿</h2>
    <input type="date" id="loveDate" class="border rounded p-2 mb-2">
    <button onclick="saveLoveDate()" class="px-4 py-2 bg-pink-400 text-white rounded-xl shadow">ç¡®å®š</button>
    <p id="loveDays" class="mt-4 text-lg font-bold text-pink-600"></p>
  </div>

  <!-- ç”Ÿæ´»ç›¸å†Œï¼ˆä¿æŒåŸæ ·ï¼‰ -->
  <div class="bg-white rounded-2xl shadow-lg p-6 w-full max-w-3xl mb-6">
    <h2 class="text-xl font-semibold mb-4">æˆ‘ä»¬çš„ç›¸å†Œ ğŸ“¸</h2>
    <input type="file" accept="image/*" multiple onchange="uploadPhotos(event)">
    <div class="flex mt-2">
      <input type="text" id="photoPath" placeholder="images/xxx.jpg" class="flex-1 p-2 border rounded mr-2">
      <button onclick="savePhotoPath()" class="px-4 py-2 bg-pink-400 text-white rounded-xl shadow">æ·»åŠ è·¯å¾„</button>
    </div>
    <div id="gallery" class="grid grid-cols-3 gap-4 mt-4"></div>
  </div>

  <script>
    // ---------- é…ç½®ï¼šä»“åº“ä¸­é»˜è®¤çš„å¤´åƒè·¯å¾„ï¼ˆå†™æ­»åœ¨ä»£ç é‡Œï¼‰ ----------
    const defaultRepo = {
      avatar1: 'images/qinbaotai.png',
      avatar2: 'images/yanxuran.png'
    };

    // ---------- å¤´åƒä¸Šä¼ ï¼ˆFileReader -> localStorageï¼‰ ----------
    function uploadAvatar(event, id) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        document.getElementById(id).src = e.target.result;
        localStorage.setItem(id, e.target.result); // ä¸Šä¼ åä¿å­˜åœ¨æœ¬åœ°ï¼ˆè¦†ç›–ä»“åº“é»˜è®¤ï¼‰
      };
      reader.readAsDataURL(file);
      // æ¸…è¾“å…¥å€¼ä»¥ä¾¿ä¸‹æ¬¡èƒ½é‡å¤é€‰æ‹©åŒä¸€æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
      event.target.value = '';
    }

    // æ¢å¤ä¸ºä»“åº“ä¸­å†™æ­»çš„å›¾ç‰‡ï¼ˆå¹¶æ¸…é™¤æœ¬åœ°ä¸Šä¼ ï¼‰
    function restoreDefault(id) {
      localStorage.removeItem(id);
      document.getElementById(id).src = defaultRepo[id];
    }

    // åˆå§‹åŒ–ï¼šä¼˜å…ˆæ˜¾ç¤º localStorage ä¸Šä¼ çš„å›¾ç‰‡ï¼Œå¦åˆ™æ˜¾ç¤ºä»“åº“é»˜è®¤è·¯å¾„
    ['avatar1','avatar2'].forEach(id => {
      const uploaded = localStorage.getItem(id);
      if (uploaded) {
        document.getElementById(id).src = uploaded;
      } else {
        document.getElementById(id).src = defaultRepo[id];
      }
    });

    // ---------- å…¶ä½™åŠŸèƒ½ï¼ˆä¸ªäººä¿¡æ¯ã€ç›¸çˆ±æ—¶é•¿ã€ç›¸å†Œï¼‰ä¿æŒåŸé€»è¾‘ ----------
    function saveInfo() {
      localStorage.setItem('info1', document.getElementById('info1').value);
      localStorage.setItem('info2', document.getElementById('info2').value);
      alert("ä¿å­˜æˆåŠŸ âœ…");
    }
    document.getElementById('info1').value = localStorage.getItem('info1') || '';
    document.getElementById('info2').value = localStorage.getItem('info2') || '';

    function saveLoveDate() {
      localStorage.setItem('loveDate', document.getElementById('loveDate').value);
      calcLoveDays();
    }
    function calcLoveDays() {
      const date = localStorage.getItem('loveDate');
      if (!date) return;
      document.getElementById('loveDate').value = date;
      const start = new Date(date);
      const now = new Date();
      const days = Math.floor((now - start) / (1000 * 60 * 60 * 24));
      document.getElementById('loveDays').innerText = `æˆ‘ä»¬å·²ç»åœ¨ä¸€èµ· ${days} å¤©å•¦ â¤ï¸`;
    }
    calcLoveDays();

    function uploadPhotos(event) {
      const files = event.target.files;
      let gallery = JSON.parse(localStorage.getItem('gallery') || '[]');
      Array.from(files).forEach(file => {
        const reader = new FileReader();
        reader.onload = e => {
          gallery.push({src: e.target.result, type: 'local'});
          localStorage.setItem('gallery', JSON.stringify(gallery));
          renderGallery();
        };
        reader.readAsDataURL(file);
      });
      event.target.value = '';
    }

    function savePhotoPath() {
      const path = document.getElementById('photoPath').value;
      if (!path) return;
      let gallery = JSON.parse(localStorage.getItem('gallery') || '[]');
      gallery.push({src: path, type: 'path'});
      localStorage.setItem('gallery', JSON.stringify(gallery));
      document.getElementById('photoPath').value = '';
      renderGallery();
    }

    function renderGallery() {
      const gallery = JSON.parse(localStorage.getItem('gallery') || '[]');
      const container = document.getElementById('gallery');
      container.innerHTML = '';
      gallery.forEach(item => {
        const img = document.createElement('img');
        img.src = item.src;
        img.className = "w-full h-32 object-cover rounded-xl";
        container.appendChild(img);
      });
    }
    renderGallery();
  </script>
</body>
</html>
